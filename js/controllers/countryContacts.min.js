ngapp.controller("CountryContactsCtrl",["$scope","factory","dataMgr","$routeParams","$anchorScroll","$location","$timeout",function(n,t,i,r,u,f,e){n.helpers=t.getHelpers();n.helpers.showLoading=!0;n.countryId=parseInt(r.id);n.country={};n.towns=[];n.contacts=[];n.notes="";n.searchDelayed="";n.helpers.delayModelSetting(n,e,"search",function(t){n.searchDelayed=t});n.searchDelayedFunc=function(t){return n.searchDelayed?t.n.toLowerCase().indexOf(n.searchDelayed.toLowerCase())>-1||t.nfs&&t.nfs.toLowerCase().indexOf(n.searchDelayed.toLowerCase())>-1||t.l.toLowerCase().indexOf(n.searchDelayed.toLowerCase())>-1:!0};n.removeSearch=function(){n.search="";n.searchDelayed="";jQuery(".mstphSearchbox").focus()};n.relevanceFunc=function(t){if(n.searchDelayed){if(t.n.toLowerCase().indexOf(n.searchDelayed.toLowerCase())>-1||t.nfs&&t.nfs.toLowerCase().indexOf(n.searchDelayed.toLowerCase())>-1)return 1;if(t.l.toLowerCase().indexOf(n.searchDelayed.toLowerCase())>-1)return 2}return 999};n.customStateFilterFunc=function(t){return n.selectedStateId==t.sid};n.positiveIdsOnly=function(n){return n.id>0};e(function(){i.setScopeCountries(function(t){n.country=i.getCountry(t,r.id);n.towns=n.country.towns;try{n.state=i.getState(n.country.states,r.sid==0?1:r.sid)}catch(u){}n.state&&(n.selectedStateId=n.state.id);i.setScopeContacts(function(t){n.contacts=i.filterByField(t,"cid",n.countryId);n.contacts.length==0?i.setScopeFirms(function(r){for(var s,e,f=i.filterByField(r,"cid",n.countryId),o=[],u=0;u<f.length;u++)f[u].cm&&f[u].cm.length>5&&(n.notes=f[u].cm),o.push({firm:f[u],cs:f[u].cs});for(u=0;u<o.length;u++)for(s=0;s<o[u].cs.length;s++)e=i.getContact(t,o[u].cs[s].id),e.cid=n.countryId,e.l="",e.f="",n.contacts.push(e);n.helpers.showLoading=!1}):n.helpers.showLoading=!1})})},n.helpers.renderDelay);n.redirectToState=function(){n.helpers.g("/countryWithStateContacts/"+n.countryId+"/"+n.selectedStateId)};u()}]);
/*
//# sourceMappingURL=countryContacts.min.js.map
*/